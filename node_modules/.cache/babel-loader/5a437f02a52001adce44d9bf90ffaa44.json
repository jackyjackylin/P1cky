{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/timmy/P1cky/src/components/contact/MapViewCluster.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef } from 'react';\nimport useSwr from 'swr';\nimport GoogleMapReact from \"google-map-react\";\nimport useSupercluster from \"use-supercluster\"; // import googleMapStyles from '../common/GoogleMapStyle'\n\nimport mpIcon from '../../assets/images/map-marker.png';\n\nconst fetcher = (...args) => fetch(...args).then(response => response.json());\n\nconst Marker = ({\n  children\n}) => children;\n\n_c = Marker;\nexport default function MapViewCluster() {\n  _s();\n\n  // 1) map setup\n  const mapRef = useRef();\n  const [zoom, setZoom] = useState(10);\n  const [bounds, setBounds] = useState(null); // 2) load and format data\n\n  const url = \"https://data.police.uk/api/crimes-street/all-crime?lat=52.6376&lng=-1.135171&data=2019-10\";\n  const {\n    data,\n    error\n  } = useSwr(url, fetcher);\n  const crimes = data && !error ? data.slice(0, 9) : [];\n  const points = crimes.map(crime => ({\n    type: \"Feature\",\n    properties: {\n      cluster: false,\n      crimeId: crime.id,\n      category: crime.category\n    },\n    geometry: {\n      type: \"Point\",\n      coordinates: [parseFloat(crime.location.longitude), parseFloat(crime.location.latitude)]\n    }\n  })); // 3) get clusters\n\n  const {\n    clusters,\n    supercluster\n  } = useSupercluster({\n    points,\n    bounds,\n    zoom,\n    options: {\n      radius: 75,\n      maxZoom: 20\n    }\n  }); // 4) render map\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-container map-height w-100\",\n      children: /*#__PURE__*/_jsxDEV(GoogleMapReact, {\n        bootstrapURLKeys: {\n          key: 'AIzaSyAYzby4yYDVaXPmtu4jZAGR258K6IYwjIY&libraries'\n        },\n        defaultCenter: {\n          lat: 52.6376,\n          lng: -1.135171\n        },\n        defaultZoom: 12,\n        yesIWantToUseGoogleMapApiInternals: true,\n        onGoogleApiLoaded: ({\n          map\n        }) => {\n          mapRef.current = map;\n        },\n        onChange: ({\n          zoom,\n          bounds\n        }) => {\n          setZoom(zoom);\n          setBounds([bounds.nw.lng, bounds.se.lat, bounds.se.lng, bounds.nw.lat]);\n        },\n        children: clusters.map(cluster => {\n          const [longitude, latitude] = cluster.geometry.coordinates;\n          const {\n            cluster: isCluster,\n            point_count: pointCount\n          } = cluster.properties;\n\n          if (isCluster) {\n            return /*#__PURE__*/_jsxDEV(Marker, {\n              lat: latitude,\n              lng: longitude,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"cluster-marker\",\n                onClick: () => {\n                  const expansionZoom = Math.min(supercluster.getClusterExpansionZoom(cluster.id), 20);\n                  mapRef.current.setZoom(expansionZoom);\n                  mapRef.current.panTo({\n                    lat: latitude,\n                    lng: longitude\n                  });\n                },\n                children: pointCount\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 79,\n                columnNumber: 37\n              }, this)\n            }, cluster.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 33\n            }, this);\n          }\n\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            lat: latitude,\n            lng: longitude,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"crime-marker\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: mpIcon,\n                alt: \"Icon\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 33\n            }, this)\n          }, cluster.properties.crimeId, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n\n_s(MapViewCluster, \"Zsyu3ZL0Mh4sibLylTASNY8gOgE=\", false, function () {\n  return [useSwr, useSupercluster];\n});\n\n_c2 = MapViewCluster;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Marker\");\n$RefreshReg$(_c2, \"MapViewCluster\");","map":{"version":3,"sources":["/home/timmy/P1cky/src/components/contact/MapViewCluster.js"],"names":["React","useState","useRef","useSwr","GoogleMapReact","useSupercluster","mpIcon","fetcher","args","fetch","then","response","json","Marker","children","MapViewCluster","mapRef","zoom","setZoom","bounds","setBounds","url","data","error","crimes","slice","points","map","crime","type","properties","cluster","crimeId","id","category","geometry","coordinates","parseFloat","location","longitude","latitude","clusters","supercluster","options","radius","maxZoom","key","lat","lng","current","nw","se","isCluster","point_count","pointCount","expansionZoom","Math","min","getClusterExpansionZoom","panTo"],"mappings":"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","sourcesContent":["import React, {useState, useRef} from 'react';\r\nimport useSwr from 'swr'\r\nimport GoogleMapReact from \"google-map-react\"\r\nimport useSupercluster from \"use-supercluster\";\r\n// import googleMapStyles from '../common/GoogleMapStyle'\r\nimport mpIcon from '../../assets/images/map-marker.png'\r\n\r\nconst fetcher = (...args) => fetch(...args).then(response => response.json());\r\n\r\nconst Marker = ({children}) => children;\r\n\r\nexport default function MapViewCluster() {\r\n\r\n    // 1) map setup\r\n    const mapRef = useRef();\r\n    const [zoom, setZoom] = useState(10);\r\n    const [bounds, setBounds] = useState(null);\r\n\r\n    // 2) load and format data\r\n    const url = \"https://data.police.uk/api/crimes-street/all-crime?lat=52.6376&lng=-1.135171&data=2019-10\";\r\n    const { data, error } = useSwr(url, fetcher);\r\n    const crimes = data && !error ? data.slice(0, 9) : [];\r\n    const points = crimes.map(crime => ({\r\n        type: \"Feature\",\r\n        properties: {\r\n            cluster: false,\r\n            crimeId: crime.id,\r\n            category: crime.category\r\n        },\r\n        geometry: {\r\n            type: \"Point\",\r\n            coordinates: [\r\n                parseFloat(crime.location.longitude),\r\n                parseFloat(crime.location.latitude)\r\n            ]\r\n        }\r\n    }))\r\n\r\n    // 3) get clusters\r\n    const { clusters, supercluster } = useSupercluster({\r\n        points,\r\n        bounds,\r\n        zoom,\r\n        options: {radius: 75, maxZoom: 20}\r\n    });\r\n\r\n    // 4) render map\r\n    return (\r\n        <>\r\n            <div className=\"map-container map-height w-100\">\r\n                <GoogleMapReact\r\n                bootstrapURLKeys={{key: 'AIzaSyAYzby4yYDVaXPmtu4jZAGR258K6IYwjIY&libraries'}}\r\n                defaultCenter={{lat: 52.6376, lng: -1.135171}}\r\n                defaultZoom={12}\r\n                yesIWantToUseGoogleMapApiInternals\r\n                onGoogleApiLoaded={({map}) => {\r\n                    mapRef.current = map;\r\n                }}\r\n                onChange={({zoom, bounds}) => {\r\n                    setZoom(zoom);\r\n                    setBounds([\r\n                        bounds.nw.lng,\r\n                        bounds.se.lat,\r\n                        bounds.se.lng,\r\n                        bounds.nw.lat\r\n                    ])\r\n                }}\r\n                >\r\n                    {clusters.map(cluster => {\r\n                        const  [longitude, latitude]  = cluster.geometry.coordinates;\r\n                        const {\r\n                            cluster: isCluster,\r\n                            point_count: pointCount\r\n                        } = cluster.properties;\r\n\r\n                        if(isCluster) {\r\n                            return (\r\n                                <Marker key={cluster.id} lat={latitude} lng={longitude}>\r\n                                    <div\r\n                                        className=\"cluster-marker\"\r\n                                        onClick={() => {\r\n                                            const expansionZoom = Math.min(\r\n                                                supercluster.getClusterExpansionZoom(cluster.id), 20\r\n                                            );\r\n                                            mapRef.current.setZoom(expansionZoom);\r\n                                            mapRef.current.panTo({lat: latitude, lng: longitude})\r\n                                        }}\r\n                                    >{pointCount}</div>\r\n                                </Marker>\r\n                            )\r\n                        }\r\n                        return (\r\n                            <Marker\r\n                                key={cluster.properties.crimeId}\r\n                                lat={latitude}\r\n                                lng={longitude}>\r\n                                <div className=\"crime-marker\">\r\n                                    <img src={mpIcon} alt=\"Icon\"/>\r\n                                </div>\r\n                            </Marker>\r\n                        )\r\n                    })}\r\n                </GoogleMapReact>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}
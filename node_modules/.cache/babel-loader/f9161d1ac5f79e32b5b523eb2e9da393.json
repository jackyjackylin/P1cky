{"ast":null,"code":"export default function sortKD(ids, coords, nodeSize, left, right, depth) {\n  if (right - left <= nodeSize) return;\n  const m = left + right >> 1;\n  select(ids, coords, m, left, right, depth % 2);\n  sortKD(ids, coords, nodeSize, left, m - 1, depth + 1);\n  sortKD(ids, coords, nodeSize, m + 1, right, depth + 1);\n}\n\nfunction select(ids, coords, k, left, right, inc) {\n  while (right > left) {\n    if (right - left > 600) {\n      const n = right - left + 1;\n      const m = k - left + 1;\n      const z = Math.log(n);\n      const s = 0.5 * Math.exp(2 * z / 3);\n      const sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n      const newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n      const newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n      select(ids, coords, k, newLeft, newRight, inc);\n    }\n\n    const t = coords[2 * k + inc];\n    let i = left;\n    let j = right;\n    swapItem(ids, coords, left, k);\n    if (coords[2 * right + inc] > t) swapItem(ids, coords, left, right);\n\n    while (i < j) {\n      swapItem(ids, coords, i, j);\n      i++;\n      j--;\n\n      while (coords[2 * i + inc] < t) i++;\n\n      while (coords[2 * j + inc] > t) j--;\n    }\n\n    if (coords[2 * left + inc] === t) swapItem(ids, coords, left, j);else {\n      j++;\n      swapItem(ids, coords, j, right);\n    }\n    if (j <= k) left = j + 1;\n    if (k <= j) right = j - 1;\n  }\n}\n\nfunction swapItem(ids, coords, i, j) {\n  swap(ids, i, j);\n  swap(coords, 2 * i, 2 * j);\n  swap(coords, 2 * i + 1, 2 * j + 1);\n}\n\nfunction swap(arr, i, j) {\n  const tmp = arr[i];\n  arr[i] = arr[j];\n  arr[j] = tmp;\n}","map":{"version":3,"sources":["/home/timmy/P1cky/node_modules/kdbush/src/sort.js"],"names":["sortKD","ids","coords","nodeSize","left","right","depth","m","select","k","inc","n","z","Math","log","s","exp","sd","sqrt","newLeft","max","floor","newRight","min","t","i","j","swapItem","swap","arr","tmp"],"mappings":"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","sourcesContent":["\nexport default function sortKD(ids, coords, nodeSize, left, right, depth) {\n    if (right - left <= nodeSize) return;\n\n    const m = (left + right) >> 1;\n\n    select(ids, coords, m, left, right, depth % 2);\n\n    sortKD(ids, coords, nodeSize, left, m - 1, depth + 1);\n    sortKD(ids, coords, nodeSize, m + 1, right, depth + 1);\n}\n\nfunction select(ids, coords, k, left, right, inc) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            const n = right - left + 1;\n            const m = k - left + 1;\n            const z = Math.log(n);\n            const s = 0.5 * Math.exp(2 * z / 3);\n            const sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            const newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            const newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            select(ids, coords, k, newLeft, newRight, inc);\n        }\n\n        const t = coords[2 * k + inc];\n        let i = left;\n        let j = right;\n\n        swapItem(ids, coords, left, k);\n        if (coords[2 * right + inc] > t) swapItem(ids, coords, left, right);\n\n        while (i < j) {\n            swapItem(ids, coords, i, j);\n            i++;\n            j--;\n            while (coords[2 * i + inc] < t) i++;\n            while (coords[2 * j + inc] > t) j--;\n        }\n\n        if (coords[2 * left + inc] === t) swapItem(ids, coords, left, j);\n        else {\n            j++;\n            swapItem(ids, coords, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swapItem(ids, coords, i, j) {\n    swap(ids, i, j);\n    swap(coords, 2 * i, 2 * j);\n    swap(coords, 2 * i + 1, 2 * j + 1);\n}\n\nfunction swap(arr, i, j) {\n    const tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n"]},"metadata":{},"sourceType":"module"}
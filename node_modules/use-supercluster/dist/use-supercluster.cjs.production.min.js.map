{"version":3,"file":"use-supercluster.cjs.production.min.js","sources":["../src/index.tsx"],"sourcesContent":["import { useRef, useState } from \"react\";\nimport Supercluster from \"supercluster\";\nimport { BBox, GeoJsonProperties } from \"geojson\";\nimport { useDeepCompareEffectNoCheck } from \"use-deep-compare-effect\";\nimport { dequal } from \"dequal\";\n\nexport interface UseSuperclusterArgument<P, C> {\n  points: Array<Supercluster.PointFeature<P>>;\n  bounds?: BBox;\n  zoom: number;\n  options?: Supercluster.Options<P, C>;\n}\n\nconst useSupercluster = <\n  P extends GeoJsonProperties = Supercluster.AnyProps,\n  C extends GeoJsonProperties = Supercluster.AnyProps\n>({\n  points,\n  bounds,\n  zoom,\n  options\n}: UseSuperclusterArgument<P, C>) => {\n  const superclusterRef = useRef<Supercluster<P, C>>();\n  const pointsRef = useRef<Array<Supercluster.PointFeature<P>>>();\n  const [clusters, setClusters] = useState<\n    Array<Supercluster.ClusterFeature<C> | Supercluster.PointFeature<P>>\n  >([]);\n  const zoomInt = Math.round(zoom);\n\n  useDeepCompareEffectNoCheck(() => {\n    if (!superclusterRef.current || !dequal(pointsRef.current, points)) {\n      superclusterRef.current = new Supercluster(options);\n      superclusterRef.current.load(points);\n    }\n\n    if (bounds) {\n      setClusters(superclusterRef.current.getClusters(bounds, zoomInt));\n    }\n\n    pointsRef.current = points;\n  }, [points, bounds, zoomInt]);\n\n  return { clusters, supercluster: superclusterRef.current };\n};\n\nexport default useSupercluster;\n"],"names":["points","bounds","zoom","options","superclusterRef","useRef","pointsRef","useState","clusters","setClusters","zoomInt","Math","round","useDeepCompareEffectNoCheck","current","dequal","Supercluster","load","getClusters","supercluster"],"mappings":"mPAawB,gBAItBA,IAAAA,OACAC,IAAAA,OACAC,IAAAA,KACAC,IAAAA,QAEMC,EAAkBC,WAClBC,EAAYD,aACcE,WAE9B,IAFKC,OAAUC,OAGXC,EAAUC,KAAKC,MAAMV,UAE3BW,+BAA4B,WACrBT,EAAgBU,SAAYC,SAAOT,EAAUQ,QAASd,KACzDI,EAAgBU,QAAU,IAAIE,EAAab,GAC3CC,EAAgBU,QAAQG,KAAKjB,IAG3BC,GACFQ,EAAYL,EAAgBU,QAAQI,YAAYjB,EAAQS,IAG1DJ,EAAUQ,QAAUd,IACnB,CAACA,EAAQC,EAAQS,IAEb,CAAEF,SAAAA,EAAUW,aAAcf,EAAgBU"}